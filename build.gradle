apply plugin: 'java'

repositories { mavenCentral() }

buildscript {
    repositories { jcenter() }
    dependencies { classpath 'eu.appsatori:gradle-fatjar-plugin:0.3' }
}

apply plugin: 'eu.appsatori.fatjar'
dependencies {
    def jetty_version = '9.2.8.v20150217'
    compile group: 'org.eclipse.jetty', name: 'jetty-webapp', version: jetty_version
    compile group: 'org.eclipse.jetty.websocket', name: 'websocket-api', version: jetty_version
    compile group: 'org.eclipse.jetty.websocket', name: 'websocket-server', version: jetty_version
    compile group: 'org.eclipse.jetty.websocket', name: 'websocket-client', version: jetty_version
    compile group: 'org.json', name: 'json', version: '20140107'
    compile group: 'javax.websocket', name: 'javax.websocket-api', version: '1.1'
    compile group: 'org.scream3r', name: 'jssc', version: '2.8.0'
}

fatJar {
    exclude 'META-INF/LICENSE.txt', 'META-INF/maven', 'about.html', 'jetty-dir.css'
    manifest {
        attributes 'Main-Class': 'Main'
    }
}

task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
}

artifacts {
    archives sourcesJar
}